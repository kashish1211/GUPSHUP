{% extends "blog/base.html" %}
{% load crispy_forms_tags%}
{% load social_share %}
{% block style %}
	.form-control-sm
	{
    min-height: 34px;
    padding: 7px 8px;
    font-size: 13px;
    color: #333;
    vertical-align: middle;
    background-color: #fff;
    background-repeat: no-repeat;
    background-position: right 8px center;
    border: 1px solid #ccc;
    border-radius: 3px;
    outline: none;
    box-shadow: inset 0 1px 2px rgb(0 0 0 / 8%);
	}
	.dropdown-menu
	{
		padding: 20px 10px 10px 10px;
		
	}

	.fa-whatsapp {
  
  color: #25D366;
}
.fa-google-plus-g {
  
  color: #db4a39;
}
.fa-envelope {
    
    color: #BB001B;
}

.fa-twitter {
    
    color: #00acee;
}
.fa-facebook-f {
    
    color: #3b5998;
}
.fa-telegram {
    
    color: #0088cc;
}

{% endblock style %}
{% block content %}

<article class="media content-section">
<!-- post details -->
	<img class="rounded-circle article-img " src={{object.author.profile.image.url}}>
	<div class="media-body">
		<div class="article-metadata">
			<a class="mr-2" href="{% url 'user-posts' object.author.username %}">{{ object.author }}</a>
			<small class="text-muted">{{ object.date_posted|date:"F d, Y" }}</small>
			{% if user.is_authenticated %}
<!-- bookmarks -->
			<form action="{% url 'post-bookmark' object.id %}" method="POST">
				{% csrf_token %}
				{% if post_is_bookmarked%}
				<button type="submit" name="post_id" value="{{object.id}}" class="btn btn-lg" style="float: right;"><i
						class="fas fa-bookmark fa-2x" style="color: red;" aria-hidden="true"></i></button>
				{% else %}
				<button type="submit" name="post_id" value="{{object.id}}" class="btn btn-lg" style="float: right;"><i
						class="far fa-bookmark fa-2x" style="color: red;" aria-hidden="true"></i></button>
				{% endif %}
			</form>
			{% else %}
			<a class="btn btn-outline-info" href="{% url 'login' %}?next={{request.path}}">Log in to Bookmark this
				article!</a><br>
			{% endif %}

			{% if object.author == user %}
<!-- post update and delete  -->
			<div>
				<a class="btn btn-warning btn-sm mt-1 mb-1" href="{% url 'post-update' object.id %}"><i
						class="fa fa-pencil-square-o" aria-hidden="true"></i>&nbsp;Edit</a>
				<a class="btn btn-danger btn-sm mt-1 mb-1" href="{% url 'post-delete' object.id %}"><i
						class="fas fa-trash" aria-hidden="true">&nbsp;</i>Delete</a>
				

			
				
					{% endif%}
<!-- share a post -->
				


			<!-- Button trigger modal -->
			<button type="button" class="btn btn-secondary btn-sm" data-toggle="modal" data-target="#exampleModalCenter">
			<i class="fas fa-share"></i> Share
			</button>

			<!-- Modal -->
			<div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
			<div class="modal-dialog modal-dialog-centered" role="document">
				<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="exampleModalLongTitle">Share</h5>
					<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
					</button>
				</div>
				<div class="modal-body ml-3">
				<div class="row my-3">
								<div class="col-3">{% post_to_facebook object_or_url '<i class="fab fa-facebook-f fa-3x mx-3"></i>' %}</div>
								<div class="col-3">{% post_to_whatsapp object_or_url '<i class="fab fa-whatsapp fa-3x mx-3"></i>' %}</div>
								<div class="col-3">{% post_to_twitter "New Post on Gupshup!!!: {{object.title}}. Check it out!" object_or_url '<i class="fab fa-twitter fa-3x mx-3"></i>' %}</div>
								<div class="col-3">{% post_to_gplus object_or_url '<i class="fab fa-3x fa-google-plus-g"></i>' %}</div>
								</div>
								<div class="row my-3">

								
								<div class="col-3" > </div>
								<div class="col-3" >{% send_email object.title "New Post: {{object.title}}. Check it out!" object_or_url '<i class="fas fa-envelope fa-3x mx-3"></i>' %}</div>
								
								<div class="col-3" >{% post_to_telegram "New Post: {{object.title}}" object_or_url '<i class="fab fa-telegram fa-3x mx-3"></i>'  %}</div>
								<div class="col-3" ></div>
								</div>
				<div class="row container-fluid">
					<input  class="form-control mx-0 px-0 col-10" value="{{ request.build_absolute_uri }}">
								<!-- Trigger -->
								 
								<button class="sharebtn col-2 btn btn-secondary" data-clipboard-text="{{ request.build_absolute_uri }}" style = "border: None;" data-toggle="tooltip" data-placement="bottom" title="Copied Link!">
								<i class="fas fa-clipboard"></i>
									
							</button>
							
						
							

				</div>
				</div>
			</div>
			</div>









			
		</div>
<!-- post content -->
		<a href="{% url 'category' object.category %}"><h6><span class="badge badge-secondary">{{ object.category }}</span></h6></a>
		<h2 class="article-title">{{ object.title | safe }} </h2>

		<p class="article-content">{{ object.content| safe }}</p>
		
		<!-- upvotes -->
		<div class='row'>
			{% if user.is_authenticated %}
			<div >
				<form action="{% url 'post-upvote' object.id %}" method="POST">
					{% csrf_token %}
					
					{% if post_is_upvoted %}
					<button type="submit" name="post_id" value="{{object.id}}" class="btn btn-lg"><i
							class="fas fa-thumbs-up" aria-hidden="true"></i></button>
					{% else %}
					<button type="submit" name="post_id" value="{{object.id}}" class="btn btn-lg"><i
							class="far fa-thumbs-up" aria-hidden="true"></i></button>
					{% endif %}
				</form>
			</div>
			<div class="my-2" >
				<strong class="text-xl-center">{{ number_of_upvotes }}</strong>
			</div>
<!-- downvotes -->
			<div>
				<form action="{% url 'post-downvote' object.id %}" method="POST">
					{% csrf_token %}
					
					{% if post_is_downvoted %}
					<button type="submit" name="post_id" value="{{object.id}}" class="btn btn-lg"><i
							class="fas fa-thumbs-down" aria-hidden="true"></i></button>
					{% else %}
					<button type="submit" name="post_id" value="{{object.id}}" class="btn btn-lg"><i
							class="far fa-thumbs-down" aria-hidden="true"></i></button>
					{% endif %}
				</form>
			</div>
			<div class="my-2" >
				<strong class="text-xl-center">{{ number_of_downvotes }}</strong>
			</div>
<!-- user authentication check -->
			{% else %}
			<a class="btn btn-outline-info" href="{% url 'login' %}?next={{request.path}}">Log in to like this
				article!</a><br>
			{% endif %}
		</div>
		<h4>Answer This Here!</h4>
		<div id="comments_section">

			{% if user.is_authenticated %}
			<form method="POST">
				{% csrf_token %}
				<div class="form-group">
					{{ comment_form|crispy }}
					<button class="btn btn-info" type="submit">Continue Discussion <i
							class="fa fa-comments"></i></button>
					
				</div>
			</form>
			{% else %}
			<a class="btn btn-outline-info" href="{% url 'login' %}?next={{request.path}}">Log in to answer
				this!</a><br>
			{% endif %}
<!-- comments -->
			{% if comments %}
				{% if  object.number_of_comments > 1 %}
			<strong class="text-secondary">{{ object.number_of_comments }} Replies</strong>
			{% else %}
				<strong class="text-secondary">{{ object.number_of_comments }} Reply</strong>
			{% endif %}
			<hr>
			<ul>
				{% for comment in comments %}
				<li>
					<div>
						<span>
							<strong class="text-info">{{ comment.author }} </strong>
							<small class="text-muted">{{ comment.date_posted }}</small>
						</span>
						<p>
							{{ comment.comment|safe }}
						</p>

					

					</div>

				<div class='row'>
			{% if user.is_authenticated %}
			<div >
				<form action="{% url 'comment-upvote' object.id comment.id %}" method="POST">
					{% csrf_token %}
<!--comment_upvotes  -->
					{% for com in comment_status%}
					
						{% if com.0 == comment.id %}
							{% if com.1  %}
								<button type="submit" name="comment_id" value="{{comment.id}}" class="btn btn-lg"><i
								class="fas fa-thumbs-up" aria-hidden="true"></i></button>
							
							{% else %}
								<button type="submit" name="comment_id" value="{{comment.id}}" class="btn btn-lg"><i
								class="far fa-thumbs-up" aria-hidden="true"></i></button>
							{% endif %}
					{% endif %}
					{% endfor %}
				</form>
			</div>
			<div class="my-2" >
				<strong class="text-xl-center">{{ comment.number_of_upvotes_comment }}</strong>
			</div>
<!-- comment-downvotes -->
			<div>
				<form action="{% url 'comment-downvote' object.id comment.id%}" method="POST">
					{% csrf_token %}

					{% for com in comment_status%}
					
						{% if com.0 == comment.id %}
							{% if com.2  %}
								<button type="submit" name="comment_id" value="{{comment.id}}" class="btn btn-lg"><i
							class="fas fa-thumbs-down" aria-hidden="true"></i></button>
						{% else %}
						<button type="submit" name="comment_id" value="{{comment.id}}" class="btn btn-lg"><i
							class="far fa-thumbs-down" aria-hidden="true"></i></button>
						{% endif %}
					{% endif %}
					{% endfor %}
					
					
				</form>
			</div>
			<div class="my-2" >
				<strong class="text-xl-center">{{ comment.number_of_downvotes_comment  }}</strong>
			</div>
			{% else %}
			<a class="btn btn-outline-info" href="{% url 'login' %}?next={{request.path}}">Log in to like this
				article!</a><br>
			{% endif %}
		</div>
				</li>
				{% endfor %}
			</ul>
			{% else %}
			<strong class="text-secondary">No Replies...</strong>
			{% endif %}

		</div>

	</div>
</article>

{% endblock content %}
{% block script %}
 new ClipboardJS('.sharebtn');


$( document ).ready(function() {
        $('[data-toggle="tooltip"]').tooltip({'placement': 'bottom', trigger: 'focus', delay:{hide:50}});
    }); 
 

{% endblock script %}